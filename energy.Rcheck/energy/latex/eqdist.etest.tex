\Header{eqdist.etest}{Multisample E-statistic (Energy) Test of Equal Distributions}
\keyword{multivariate}{eqdist.etest}
\keyword{htest}{eqdist.etest}
\keyword{nonparametric}{eqdist.etest}
\begin{Description}\relax
Performs the nonparametric multisample E-statistic (energy) test
for equality of multivariate distributions.
\end{Description}
\begin{Usage}
\begin{verbatim}
 eqdist.etest(x, sizes, distance = FALSE, 
              incomplete = FALSE, N = 100, R = 999)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] data matrix of pooled sample
\item[\code{sizes}] vector of sample sizes
\item[\code{distance}] logical: if TRUE, first argument is a distance matrix
\item[\code{incomplete}] logical: if TRUE, compute incomplete \eqn{\mathcal{E}}{E}-statistics
\item[\code{N}] incomplete sample size
\item[\code{R}] number of bootstrap replicates 
\end{ldescription}
\end{Arguments}
\begin{Details}\relax
The k-sample multivariate \eqn{\mathcal{E}}{E}-test of equal distributions
is performed. The statistic is computed from the original
pooled samples, stacked in matrix \code{x} where each row
is a multivariate observation, or the corresponding distance matrix. The
first \code{sizes[1]} rows of \code{x} are the first sample, the next
\code{sizes[2]} rows of \code{x} are the second sample, etc.

The test is implemented by nonparametric bootstrap, an approximate 
permutation test with \code{R} replicates.

The definition of the multisample \eqn{\mathcal{E}}{E}-statistic is given in the 
\code{\Link{ksample.e}} documentation.

If \code{incomplete==TRUE}, incomplete \eqn{\mathcal{E}}{E}-statistics (which are
incomplete V-statistics) are computed. That is, at most
\code{N} observations from each sample are used, by sampling without replacement 
as needed.\end{Details}
\begin{Value}
A list with class \code{etest.eqdist} containing
\begin{ldescription}
\item[\code{method}] Description of test
\item[\code{statistic}] Observed value of the test statistic
\item[\code{p.value}] Approximate p-value of the test
\item[\code{sizes}] Vector of sample sizes
\item[\code{R}] Number of replicates
\item[\code{incomplete}] Argument \code{incomplete}
\item[\code{N}] Argument \code{N}
\item[\code{replicates}] Vector of replicates of the statistic
\end{ldescription}
\end{Value}
\begin{Author}\relax
Maria Rizzo \email{rizzo@math.ohiou.edu}
\end{Author}
\begin{References}\relax
Szekely, G. J. and Rizzo, M. L. (2003) Testing for Equal
Distributions in High Dimension, submitted.

Szekely, G. J. (2000) \eqn{\mathcal{E}}{E}-statistics: Energy of 
Statistical Samples, preprint.\end{References}
\begin{SeeAlso}\relax
\code{\Link{ksample.e}},
\code{\Link{print.etest.eqdist}}
\end{SeeAlso}
\begin{Examples}
\begin{ExampleCode}
 ## test if the 3 varieties of iris data (d=4) have equal distributions
 data(iris)
 eqdist.etest(iris[,1:4], c(50,50,50))
 
 ## univariate two-sample test using incomplete E-statistics
 x1 <- rnorm(200)
 x2 <- rnorm(300, .5)
 eqdist.etest(c(x1, x2), c(200, 300), incomplete=TRUE, N=100)
\end{ExampleCode}
\end{Examples}

