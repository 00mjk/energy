<html><head><title>R: E-statistic (Energy Statistic) for Multivariate k-sample Test of Equal Distributions</title>
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for ksample.e {energy}"><tr><td>ksample.e {energy}</td><td align="right">R Documentation</td></tr></table>
<h2>E-statistic (Energy Statistic) for Multivariate k-sample Test of Equal Distributions</h2>


<h3>Description</h3>

<p>
Returns the E-statistic (energy statistic)
for the multivariate k-sample test of equal distributions.
</p>


<h3>Usage</h3>

<pre>
 ksample.e(x, sizes, distance = FALSE, ix = 1:sum(sizes), 
           incomplete = FALSE, N = 100)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
data matrix of pooled sample</td></tr>
<tr valign="top"><td><code>sizes</code></td>
<td>
vector of sample sizes</td></tr>
<tr valign="top"><td><code>distance</code></td>
<td>
logical: if TRUE, x is a distance matrix</td></tr>
<tr valign="top"><td><code>ix</code></td>
<td>
a permutation of the row indices of x </td></tr>
<tr valign="top"><td><code>incomplete</code></td>
<td>
logical: if TRUE, compute incomplete <i>E</i>-statistics</td></tr>
<tr valign="top"><td><code>N</code></td>
<td>
incomplete sample size</td></tr>
</table>

<h3>Details</h3>

<p>
The k-sample multivariate <i>E</i>-statistic for testing equal distributions
is returned. The statistic is computed from the original pooled samples, stacked in 
matrix <code>x</code> where each row is a multivariate observation, or from the distance 
matrix <code>x</code> of the original data. The
first <code>sizes[1]</code> rows of <code>x</code> are the first sample, the next
<code>sizes[2]</code> rows of <code>x</code> are the second sample, etc.
</p>
<p>
The two-sample <i>E</i>-statistic proposed by Szekely and Rizzo (2003)
is the e-distance <i>e(S_i,S_j)</i>, defined for two samples <i>S_i, S_j</i>
of size <i>n_i, n_j</i> by
</p><p align="center"><i>e(S_i, S_j) = (n_i n_j)(n_i+n_j)[2M_(ij)-M_(ii)-M_(jj)],</i></p><p>
where
</p><p align="center"><i>M_{ij} = 1/(n_i n_j) sum[1:n_i, 1:n_j] ||X_(ip) - X_(jq)||,</i></p><p>
<i>|| ||</i> denotes Euclidean norm, and <i>X_(ip)</i> denotes the p-th observation in the i-th sample.  
The k-sample  
<i>E</i>-statistic is defined by summing the pairwise e-distances over 
all <i>k(k-1)/2</i> pairs 
of samples:
</p><p align="center"><i><EM>E</EM> = sum[i&lt;j] e(S_i,S_j).</i></p><p>  
Large values of <i><EM>E</EM></i> are significant.
</p>
<p>
If <code>incomplete==TRUE</code>, an incomplete <i>E</i>-statistic (which is an
incomplete V-statistic) is computed. That is, at most
<code>N</code> observations from each sample are used, 
by sampling without replacement as needed.
</p>


<h3>Value</h3>

<p>
The value of the multisample <i>E</i>-statistic corresponding to
the permutation <code>ix</code> is returned.</p>

<h3>Note</h3>

<p>
This function computes the <i>E</i>-statistic only. 
For the test decision,
a nonparametric bootstrap test (approximate permutation test)
is provided by the function <code><a href="eqdist.etest.html">eqdist.etest</a></code>.
</p>


<h3>Author(s)</h3>

<p>
Maria Rizzo <a href="mailto:rizzo@math.ohiou.edu">rizzo@math.ohiou.edu</a>
</p>


<h3>References</h3>

<p>
Szekely, G. J. and Rizzo, M. L. (2003) Testing for Equal
Distributions in High Dimension, submitted.
</p>
<p>
Szekely, G. J. (2000) <i>E</i>-statistics: Energy of 
Statistical Samples, preprint.
</p>


<h3>See Also</h3>

<p>
<code><a href="eqdist.etest.html">eqdist.etest</a></code>
</p>


<h3>Examples</h3>

<pre>
## compute 3-sample E-statistic for 4-dimensional iris data
 data(iris)
 ksample.e(iris[,1:4], c(50,50,50))

## compute univariate two-sample incomplete E-statistic
 x1 &lt;- rnorm(200)
 x2 &lt;- rnorm(300, .5)
 x &lt;- c(x1, x2)
 ksample.e(x, c(200, 300), incomplete=TRUE, N=100)
 
</pre>



<hr><div align="center"><a href="00Index.html">[Package Contents]</a></div>

</body></html>
